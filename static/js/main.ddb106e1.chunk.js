(this["webpackJsonpchat-stats"]=this["webpackJsonpchat-stats"]||[]).push([[0],{136:function(e,t,a){e.exports=a(312)},141:function(e,t,a){},142:function(e,t,a){},312:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(18),c=a.n(o),l=(a(141),a(11)),s=(a(142),a(125)),i=a.n(s),u=(a(159),a(317)),m=a(318),d=a(322),g=a(321),E=a(319),f=a(128),b=a(50),h=a(320),v=a(127),p=a(13),y=function(e){var t=e.currentPage,a=e.maxPage,n=e.setCurrentPage,o=[];if(a<7)for(var c=function(e){o.push(r.a.createElement(p.a.Item,{key:e,active:e===t,onClick:function(){return n(e)}},e))},l=1;l<a+1;l++)c(l);else{var s=t-2;if(s<2){for(var i=function(e){o.push(r.a.createElement(p.a.Item,{key:e,active:e===t,onClick:function(){return n(e)}},e))},u=1;u<7;u++)i(u);o.push(r.a.createElement(p.a.Ellipsis,{key:"next"}))}else if(a-t<3){o.push(r.a.createElement(p.a.Ellipsis,{key:"previous"}));for(var m=function(e){o.push(r.a.createElement(p.a.Item,{key:e,active:e===t,onClick:function(){return n(e)}},e))},d=a-4;d<a+1;d++)m(d)}else{o.push(r.a.createElement(p.a.Ellipsis,{key:"previous"}));for(var g=function(e){o.push(r.a.createElement(p.a.Item,{key:e,active:e===t,onClick:function(){return n(e)}},e))},E=s;E<s+5;E++)g(E);o.push(r.a.createElement(p.a.Ellipsis,{key:"next"}))}}return r.a.createElement(p.a,null,r.a.createElement(p.a.First,{onClick:function(){return n(1)}}),r.a.createElement(p.a.Prev,{onClick:function(){t>1&&n(t-1)}}),o,r.a.createElement(p.a.Next,{onClick:function(){t<a&&n(t+1)}}),r.a.createElement(p.a.Last,{onClick:function(){return n(a)}}))},k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sept","Oct","Nov","Dec"],C=function(e){var t=Object(n.useState)(!1),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(1),i=Object(l.a)(s,2),m=i[0],d=i[1],g=Object(n.useState)(Math.ceil(Object.keys(e.by_date).length/5)),E=Object(l.a)(g,1)[0],f=function(){o?e.setStatsByDate(e.by_date.sort((function(e,t){return e.date>t.date?1:-1}))):e.setStatsByDate(e.by_date.sort((function(e,t){return e.date>t.date?-1:1}))),c(!o)};return r.a.createElement("div",null,r.a.createElement(u.a,null,r.a.createElement(v.a,{responsive:!0,size:"sm"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"conversation_count"),r.a.createElement("th",null,"missed_chat_count"),r.a.createElement("th",null,"visitors_with_conversation_count"),o?r.a.createElement("th",{style:{cursor:"pointer"},onClick:function(){return f()}},"Date \u25b2"):r.a.createElement("th",{style:{cursor:"pointer"},onClick:function(){return f()}},"Date \u25bc"))),r.a.createElement("tbody",null,function(){var t=5*m,a=t-5;return e.by_date.slice(a,t).map((function(e,t){var a=new Date(e.date);return r.a.createElement("tr",{key:t},r.a.createElement("td",null,e.conversation_count),r.a.createElement("td",null,e.missed_chat_count),r.a.createElement("td",null,e.visitors_with_conversation_count),r.a.createElement("td",null,"".concat(a.getDate()," ").concat(k[a.getMonth()]," (").concat(a.getFullYear(),")")))}))}()))),r.a.createElement(u.a,{className:"justify-content-center"},r.a.createElement(y,{currentPage:m,maxPage:E,setCurrentPage:d})))},j=a(129),O=a.n(j),_=(a(160),a(89)),S=function(e){var t=r.a.forwardRef((function(e,t){return r.a.createElement(_.a,{onClick:e.onClick,style:{color:"#495057",backgroundColor:"#fff",border:"1px solid #ced4da"}},e.value)})),a=r.a.createRef();return r.a.createElement(f.a,{sm:!0,xs:8,style:{margin:"0.5rem"}},r.a.createElement(b.a.Label,{style:{paddingLeft:"0"}},e.label),r.a.createElement("div",null,r.a.createElement(O.a,{className:"form-control",selected:e.date,onChange:e.handleChange,dateFormat:"yyyy-MM-dd",customInput:r.a.createElement(t,{ref:a,onClick:null,value:null})})))},w=a(92),x=function(e,t,a){for(var n=[],r=0;r<3;r++)n.push({label:e[r],fill:!1,lineTension:.1,backgroundColor:a[r],borderColor:a[r],borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",pointBorderColor:a[r],pointBackgroundColor:a[r],pointBorderWidth:1,pointHoverRadius:5,pointHoverBackgroundColor:a[r],pointHoverBorderColor:a[r],pointHoverBorderWidth:2,pointRadius:1,pointHitRadius:10,data:t[r]});return n},D=function(e){var t=e.stats,a=Object(n.useState)("Bar"),o=Object(l.a)(a,2),c=o[0],s=o[1];Object(n.useEffect)((function(){}),[c]);for(var i=[],u=[],m=[],d=[],g=0;g<t.length;g++)i.push(t[g].date),u.push(t[g].conversation_count),m.push(t[g].missed_chat_count),d.push(t[g].visitors_with_conversation_count);var E={labels:i,datasets:x(["conversation_count","visitors_with_conversation_count","missed_chat_count"],[u,d,m],["rgba(75,192,192,1)","rgba(114, 215, 101, 1)","rgba(237, 94, 99, 1)"])};return r.a.createElement("div",{style:{width:"100%"}},r.a.createElement(b.a.Label,{style:{marginLeft:"1rem"}},"Chart Type"),r.a.createElement(b.a.Control,{as:"select",style:{maxWidth:"200px",marginLeft:"1rem",marginBottom:"1rem"},onChange:function(e){s(e.target.value)}},r.a.createElement("option",null,"Bar"),r.a.createElement("option",null,"Line")),function(){switch(c){case"Bar":return r.a.createElement(w.a,{data:E});case"Line":return r.a.createElement(w.b,{data:E});default:return r.a.createElement("div",null)}}())},B=a(31),T=function(e){return r.a.createElement(B.a,Object.assign({},e,{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(B.a.Body,null,r.a.createElement("b",null,e.message)),r.a.createElement(B.a.Footer,null,r.a.createElement(_.a,{onClick:e.onHide},"Close")))},N=function(e){return r.a.createElement(B.a,Object.assign({},e,{size:"lg","aria-labelledby":"contained-modal-title-vcenter",centered:!0}),r.a.createElement(B.a.Header,null,"Invalid Access Token!"),r.a.createElement(B.a.Body,null,r.a.createElement(b.a.Label,null,"Enter Valid Access Token"),r.a.createElement("input",{value:e.token,className:"form-control",placeholder:"Access token",onChange:e.onChange})),r.a.createElement(B.a.Footer,null,r.a.createElement(_.a,{onClick:e.onHide},"Enter")))},I=function(e){var t={color:"#fff",borderRadius:"5rem",height:"15em",margin:"2rem",boxShadow:"2px 3px 6px 2px rgba(0,0,0,0.2)",textShadow:"0px 0px 6px rgba(0,0,0,0.5)"},a={backgroundColor:"rgba(75,192,192,1)"},n={backgroundColor:"rgba(237, 94, 99, 1)"},o={backgroundColor:"rgba(114, 215, 101, 1)"};return r.a.createElement(u.a,{className:"justify-content-center",style:{marginTop:"4rem",marginBottom:"4rem"}},r.a.createElement(f.a,{lg:!0,sm:8,style:Object.assign({},t,a)},r.a.createElement("h1",{className:"text-center",style:{marginTop:"2rem"}},e.conversationCount),r.a.createElement("h2",{className:"text-center"},"Total conversation count")),r.a.createElement(f.a,{md:!0,sm:8,style:Object.assign({},t,n)},r.a.createElement("h1",{className:"text-center",style:{marginTop:"2rem"}},e.userMessageCount),r.a.createElement("h2",{className:"text-center"},"Total user message count")),r.a.createElement(f.a,{md:!0,sm:8,style:Object.assign({},t,o)},r.a.createElement("h1",{className:"text-center",style:{marginTop:"2rem"}},e.visitorMessageCount),r.a.createElement("h2",{className:"text-center"},"Total visitor message count")))},M=function(e,t,a){var n=(t.getTime()-e.getTime())/864e5;return console.log(n),n>a},H=function(){var e=Object(n.useRef)(!1),t=Object(n.useState)(!0),a=Object(l.a)(t,2),o=a[0],c=a[1],s=Object(n.useState)(new Date(2017,5,1)),v=Object(l.a)(s,2),p=v[0],y=v[1],k=Object(n.useState)(new Date(2017,6,18)),j=Object(l.a)(k,2),O=j[0],_=j[1],w=Object(n.useState)(""),x=Object(l.a)(w,2),B=x[0],H=x[1],L=Object(n.useState)(0),R=Object(l.a)(L,2),A=R[0],P=R[1],F=Object(n.useState)(0),J=Object(l.a)(F,2),W=J[0],z=J[1],q=Object(n.useState)(0),V=Object(l.a)(q,2),Y=V[0],$=V[1],G=Object(n.useState)([]),K=Object(l.a)(G,2),Q=K[0],U=K[1],X=Object(n.useState)(!1),Z=Object(l.a)(X,2),ee=Z[0],te=Z[1],ae=Object(n.useState)(""),ne=Object(l.a)(ae,2),re=ne[0],oe=ne[1],ce=Object(n.useState)(!1),le=Object(l.a)(ce,2),se=le[0],ie=le[1],ue=function(e,t,a){if(null!==e&&void 0!==e&&e.length>0){var n=t.toISOString().split("T",1)[0],r=a.toISOString().split("T",1)[0],o={headers:{Authorization:e,Accept:"application/json"}};c(!0),i.a.get("".concat("https://api.giosg.com/api/reporting/v1/rooms/84e0fefa-5675-11e7-a349-00163efdd8db/chat-stats/daily/","?start_date=").concat(n,"&end_date=").concat(r),o).then((function(e){var t=e.data,a=t.total_conversation_count,n=t.total_user_message_count,r=t.total_visitor_message_count,o=t.by_date;P(a),z(n),$(r),U(o.sort((function(e,t){return e.date>t.date?1:-1})))})).catch((function(e){401===e.status||401===e.response.status?ie(!0):400===e.response.status?(oe("400 Bad Request"),te(!ee)):(oe("Oops! Something went wrong."),te(!ee)),me()})).then((function(){c(!1)}))}else ie(!0),me()};Object(n.useEffect)((function(){if(e.current)ue(B,p,O);else{var t=localStorage.getItem("startDate"),a=localStorage.getItem("endDate"),n=localStorage.getItem("token");null!==t&&void 0!==t?y(new Date(t)):t="2017-5-1",null!==a&&void 0!==a?_(new Date(a)):a="2017-6-18",null!==n&&void 0!==n?H(n):n="",ue(n,new Date(t),new Date(a)),e.current=!0}}),[p,O]);var me=function(){P(0),z(0),$(0),U([])},de=function(e){H(e.target.value),localStorage.setItem("token",e.target.value)};return r.a.createElement("div",null,r.a.createElement(d.a,{bg:"dark",variant:"dark",style:{marginBottom:"2rem"}},r.a.createElement(d.a.Brand,{style:{marginRight:"3rem"}},"Chat Stats Reporting"),r.a.createElement(g.a,{className:"ml-auto"},r.a.createElement(d.a.Text,{className:"justify-content-center"},"Created by Eero Tuure"))),r.a.createElement(E.a,null,r.a.createElement(u.a,{className:"justify-content-center"},r.a.createElement(S,{label:"Start Date",date:p,handleChange:function(e){void 0!==e&&(e>O?(oe("Start date can't be greater than end date!"),te(!ee)):M(e,O,730)?(oe("Maximum date range length is 730 days."),te(!ee)):(y(e),localStorage.setItem("startDate",e)))}}),r.a.createElement(S,{label:"End Date",date:O,handleChange:function(e){void 0!==e&&(e<p?(oe("End date can't be greater than start date!"),te(!ee)):e>new Date(Date.now())?(oe("Date must be before current date!"),te(!ee)):M(p,e,730)?(oe("Maximum date range length is 730 days."),te(!ee)):(_(e),localStorage.setItem("endDate",e)))}}),r.a.createElement(f.a,{sm:!0,xs:8,style:{margin:"0.5rem"}},r.a.createElement(b.a.Label,null,"Access Token"),r.a.createElement("div",null,r.a.createElement("input",{value:B,className:"form-control",placeholder:"Access token",onChange:de,onBlur:function(){return ue(B,p,O)}})))),o?r.a.createElement(u.a,{className:"justify-content-center",style:{marginTop:"5rem"}},r.a.createElement(h.a,{animation:"border",style:{width:"10rem",height:"10rem"}})):Q.length>0?r.a.createElement("div",null,r.a.createElement(I,{conversationCount:A,userMessageCount:W,visitorMessageCount:Y}),r.a.createElement(C,{by_date:Q,setStatsByDate:U}),r.a.createElement(u.a,{style:{marginTop:"2rem",marginBottom:"3rem"}},r.a.createElement(D,{stats:Q}))):r.a.createElement(m.a,{style:{marginTop:"4rem"}},r.a.createElement("b",null,"No data found for the specified time period :(")),r.a.createElement(N,{show:se,onHide:function(){ie(!1),ue(B,p,O)},token:B,onChange:de,backdrop:"static",keyboard:!1}),r.a.createElement(T,{show:ee,onHide:function(){te(!1),oe("")},message:re})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[136,1,2]]]);
//# sourceMappingURL=main.ddb106e1.chunk.js.map